<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù… - ÙˆØ§Ø¬Ù‡Ø© Ù…Ø­Ø³Ù†Ø©</title>
    <link rel="icon" href="https://img.icons8.com/ios-filled/64/4a90e2/checklist.svg" type="image/svg+xml">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap');

        :root {
            --primary-color: #4a90e2;
            --secondary-color: #f8f9fa;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --info-color: #17a2b8;
            --dark-color: #343a40;
            --light-color: #f8f9fa;
            --white: #ffffff;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--dark-color);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            color: #666;
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 10px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            overflow-x: auto;
        }

        .nav-tab {
            flex: 1;
            min-width: 150px;
            padding: 15px 20px;
            background: transparent;
            border: none;
            border-radius: calc(var(--border-radius) - 5px);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            white-space: nowrap;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .nav-tab:hover {
            background: var(--secondary-color);
        }

        .nav-tab.active {
            background: var(--primary-color);
            color: var(--white);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
        }

        /* Stats Cards */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 25px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--info-color));
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1rem;
            color: #666;
            font-weight: 500;
        }

        /* Content Area */
        .content-area {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: var(--shadow);
            min-height: 400px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Task Cards */
        .tasks-grid {
            display: grid;
            gap: 20px;
            margin-top: 20px;
        }

        .task-card {
            background: var(--white);
            border: 2px solid #e9ecef;
            border-radius: var(--border-radius);
            padding: 20px;
            transition: var(--transition);
            position: relative;
        }

        .task-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-color: var(--primary-color);
        }

        .task-card.completed {
            background: #f8fff8;
            border-color: var(--success-color);
        }

        .task-card.completed .task-title {
            text-decoration: line-through;
            opacity: 0.7;
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .task-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 8px;
        }

        .task-id {
            background: var(--primary-color);
            color: var(--white);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .task-description {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .task-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            color: #666;
        }

        .priority-badge, .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .priority-high { background: #ffe6e6; color: #d63384; }
        .priority-medium { background: #fff3cd; color: #856404; }
        .priority-low { background: #d1ecf1; color: #0c5460; }

        .status-completed { background: #d4edda; color: #155724; }
        .status-pending { background: #f8d7da; color: #721c24; }

        .task-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .btn-success {
            background: var(--success-color);
            color: var(--white);
        }

        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: var(--danger-color);
            color: var(--white);
        }

        .btn-danger:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .btn-primary {
            background: var(--primary-color);
            color: var(--white);
        }

        .btn-primary:hover {
            background: #357abd;
            transform: translateY(-2px);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: var(--dark-color);
        }

        /* Day Management */
        .day-management {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .day-timer {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow);
            text-align: center;
            min-width: 200px;
        }

        .timer-display {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .timer-label {
            color: #666;
            font-size: 0.9rem;
        }

        /* Archived Days */
        .archived-day {
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 20px;
        }

        .archived-day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #dee2e6;
        }

        .archived-date {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark-color);
        }

        .archived-stats {
            display: flex;
            gap: 15px;
            font-size: 0.9rem;
            color: #666;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-tabs {
                flex-direction: column;
                gap: 5px;
            }
            
            .nav-tab {
                min-width: auto;
            }
            
            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .day-management {
                flex-direction: column;
                align-items: center;
            }
            
            .task-header {
                flex-direction: column;
                gap: 10px;
            }
            
            .task-actions {
                flex-wrap: wrap;
            }
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 25px;
            border-radius: 25px;
            color: var(--white);
            font-weight: 500;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        .notification.success { background: var(--success-color); }
        .notification.error { background: var(--danger-color); }
        .notification.info { background: var(--info-color); }

        @keyframes slideIn {
            from {
                transform: translateX(-50%) translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 40px;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ğŸ“‹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø°ÙƒÙŠØ©</h1>
            <p>Ø¥Ø¯Ø§Ø±Ø© Ù…Ù‡Ø§Ù…Ùƒ Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ¨Ø³Ø§Ø·Ø©</p>
        </div>

        <!-- Stats -->
        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-number" id="totalTasks">0</div>
                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù‡Ø§Ù…</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="pendingTasks">0</div>
                <div class="stat-label">Ù…Ù‡Ø§Ù… Ù…Ø¹Ù„Ù‚Ø©</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="completedTasks">0</div>
                <div class="stat-label">Ù…Ù‡Ø§Ù… Ù…ÙƒØªÙ…Ù„Ø©</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="todayTasks">0</div>
                <div class="stat-label">Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…</div>
            </div>
        </div>

        <!-- Day Management -->
        <div class="day-management">
            <div class="day-timer">
                <div class="timer-display" id="dayTimer">12:00</div>
                <div class="timer-label">Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù„Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ…</div>
            </div>
            <button class="btn btn-primary" onclick="endCurrentDay()">
                ğŸŒ™ Ù‡Ø°Ø§ ØªÙŠØ³Øª Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ
            </button>
        </div>

        <!-- Navigation Tabs -->
        <div class="nav-tabs">
            <button class="nav-tab active" data-tab="all" onclick="switchTab('all')">
                ğŸ“ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù…
            </button>
            <button class="nav-tab" data-tab="today" onclick="switchTab('today')">
                ğŸ“… Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…
            </button>
            <button class="nav-tab" data-tab="pending" onclick="switchTab('pending')">
                â³ Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©
            </button>
            <button class="nav-tab" data-tab="completed" onclick="switchTab('completed')">
                âœ… Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©
            </button>
            <button class="nav-tab" data-tab="high" onclick="switchTab('high')">
                ğŸ”¥ Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©
            </button>
            <button class="nav-tab" data-tab="archive" onclick="switchTab('archive')">
                ğŸ“¦ Ø§Ù„Ø£Ø±Ø´ÙŠÙ
            </button>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- All Tasks Tab -->
            <div class="tab-content active" id="tab-all">
                <div class="tasks-grid" id="allTasksContainer">
                    <!-- Ø§Ù„Ù…Ù‡Ø§Ù… Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
                </div>
            </div>

            <!-- Today Tasks Tab -->
            <div class="tab-content" id="tab-today">
                <div class="tasks-grid" id="todayTasksContainer">
                    <!-- Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ… Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
                </div>
            </div>

            <!-- Pending Tasks Tab -->
            <div class="tab-content" id="tab-pending">
                <div class="tasks-grid" id="pendingTasksContainer">
                    <!-- Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
                </div>
            </div>

            <!-- Completed Tasks Tab -->
            <div class="tab-content" id="tab-completed">
                <div class="tasks-grid" id="completedTasksContainer">
                    <!-- Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
                </div>
            </div>

            <!-- High Priority Tasks Tab -->
            <div class="tab-content" id="tab-high">
                <div class="tasks-grid" id="highTasksContainer">
                    <!-- Ø§Ù„Ù…Ù‡Ø§Ù… Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
                </div>
            </div>

            <!-- Archive Tab -->
            <div class="tab-content" id="tab-archive">
                <div id="archiveContainer">
                    <!-- Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
                </div>
            </div>

            <!-- Loading State -->
            <div class="loading" id="loadingState" style="display: none;">
                <div class="loading-spinner"></div>
                <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‡Ø§Ù…...</p>
            </div>
        </div>
    </div>

    <script>
        // Global Variables
        let tasks = [];
        let archivedDays = [];
        let currentTab = 'all';
        let dayStartTime = new Date();
        let dayTimer = null;

        // Initialize App
        window.addEventListener('load', () => {
            loadTasks();
            startDayTimer();
        });

        // Load Tasks
        async function loadTasks() {
            showLoading(true);
            
            try {
                const response = await fetch('tasks.json');
                
                if (response.ok) {
                    const data = await response.json();
                    tasks = data.tasks || [];
                    archivedDays = data.archivedDays || [];
                    dayStartTime = data.dayStartTime ? new Date(data.dayStartTime) : new Date();
                } else {
                    // Use sample data if file doesn't exist
                    tasks = generateSampleTasks();
                    archivedDays = generateSampleArchive();
                }
                
                updateStats();
                displayCurrentTab();
            } catch (error) {
                console.log('Using sample data');
                tasks = generateSampleTasks();
                archivedDays = generateSampleArchive();
                updateStats();
                displayCurrentTab();
            } finally {
                showLoading(false);
            }
        }

        // Generate Sample Tasks
        function generateSampleTasks() {
            const today = new Date();
            const yesterday = new Date(today);
            yesterday.setDate(yesterday.getDate() - 1);
            
            return [
                {
                    id: 1,
                    title: "ØªØ­Ø¶ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ",
                    description: "Ø¥Ø¹Ø¯Ø§Ø¯ ØªÙ‚Ø±ÙŠØ± Ø´Ø§Ù…Ù„ Ø¹Ù† Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø´Ø±ÙƒØ© ÙÙŠ Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø§Ø¶ÙŠ",
                    priority: "Ø¹Ø§Ù„ÙŠ",
                    status: "Ù…Ø¹Ù„Ù‚",
                    completed: false,
                    createdAt: today.toISOString(),
                    userId: 123456789,
                    username: "ahmed_user"
                },
                {
                    id: 2,
                    title: "Ø´Ø±Ø§Ø¡ Ø§Ù„Ø¨Ù‚Ø§Ù„Ø©",
                    description: "Ø´Ø±Ø§Ø¡ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª Ù…Ù† Ø§Ù„Ø³ÙˆØ¨Ø± Ù…Ø§Ø±ÙƒØª",
                    priority: "Ù…ØªÙˆØ³Ø·",
                    status: "Ù…ÙƒØªÙ…Ù„",
                    completed: true,
                    createdAt: yesterday.toISOString(),
                    completedAt: today.toISOString(),
                    userId: 123456789,
                    username: "sara_user"
                },
                {
                    id: 3,
                    title: "Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„Ø§Øª",
                    description: "Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ù‡Ù…Ø©",
                    priority: "Ù…ØªÙˆØ³Ø·",
                    status: "Ù…Ø¹Ù„Ù‚",
                    completed: false,
                    createdAt: today.toISOString(),
                    userId: 123456789,
                    username: "mohammed_user"
                },
                {
                    id: 4,
                    title: "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",
                    description: "Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØµÙ…ÙŠÙ…",
                    priority: "Ø¹Ø§Ù„ÙŠ",
                    status: "Ù…ÙƒØªÙ…Ù„",
                    completed: true,
                    createdAt: today.toISOString(),
                    completedAt: today.toISOString(),
                    userId: 123456789,
                    username: "fatima_user"
                }
            ];
        }

        // Generate Sample Archive
        function generateSampleArchive() {
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            
            return [
                {
                    date: yesterday.toISOString(),
                    endDate: yesterday.toISOString(),
                    tasks: [
                        {
                            id: 100,
                            title: "Ø§Ø¬ØªÙ…Ø§Ø¹ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ",
                            description: "Ù…Ù†Ø§Ù‚Ø´Ø© Ø®Ø·Ø© Ø§Ù„Ø¹Ù…Ù„ Ù„Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ù‚Ø§Ø¯Ù…",
                            priority: "Ù…ØªÙˆØ³Ø·",
                            status: "Ù…ÙƒØªÙ…Ù„",
                            completed: true,
                            createdAt: yesterday.toISOString(),
                            completedAt: yesterday.toISOString(),
                            userId: 123456789,
                            username: "team_lead"
                        }
                    ]
                }
            ];
        }

        // Update Statistics
        function updateStats() {
            const total = tasks.length;
            const pending = tasks.filter(task => !task.completed).length;
            const completed = tasks.filter(task => task.completed).length;
            const today = tasks.filter(task => isToday(task.createdAt)).length;

            document.getElementById('totalTasks').textContent = total;
            document.getElementById('pendingTasks').textContent = pending;
            document.getElementById('completedTasks').textContent = completed;
            document.getElementById('todayTasks').textContent = today;
        }

        // Check if date is today
        function isToday(dateString) {
            const date = new Date(dateString);
            const today = new Date();
            return date.toDateString() === today.toDateString();
        }

        // Switch Tab
        function switchTab(tabName) {
            currentTab = tabName;
            
            // Update tab buttons
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`tab-${tabName}`).classList.add('active');
            
            // Display content
            displayCurrentTab();
        }

        // Display Current Tab
        function displayCurrentTab() {
            switch(currentTab) {
                case 'all':
                    displayTasks(tasks, 'allTasksContainer');
                    break;
                case 'today':
                    displayTasks(tasks.filter(task => isToday(task.createdAt)), 'todayTasksContainer');
                    break;
                case 'pending':
                    displayTasks(tasks.filter(task => !task.completed), 'pendingTasksContainer');
                    break;
                case 'completed':
                    displayTasks(tasks.filter(task => task.completed), 'completedTasksContainer');
                    break;
                case 'high':
                    displayTasks(tasks.filter(task => task.priority === 'Ø¹Ø§Ù„ÙŠ'), 'highTasksContainer');
                    break;
                case 'archive':
                    displayArchive();
                    break;
            }
        }

        // Display Tasks
        function displayTasks(taskList, containerId) {
            const container = document.getElementById(containerId);
            
            if (taskList.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“</div>
                        <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù…</h3>
                        <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØµÙ†ÙŠÙ Ø­Ø§Ù„ÙŠØ§Ù‹</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = taskList.map(task => createTaskCard(task)).join('');
        }

        // Create Task Card
        function createTaskCard(task) {
            const priorityClass = `priority-${task.priority === 'Ø¹Ø§Ù„ÙŠ' ? 'high' : task.priority === 'Ù…ØªÙˆØ³Ø·' ? 'medium' : 'low'}`;
            const statusClass = task.completed ? 'completed' : '';
            const statusIcon = task.completed ? 'âœ…' : 'â³';
            const priorityIcon = {
                'Ø¹Ø§Ù„ÙŠ': 'ğŸ”¥',
                'Ù…ØªÙˆØ³Ø·': 'ğŸ“‹',
                'Ù…Ù†Ø®ÙØ¶': 'ğŸ“'
            }[task.priority] || 'ğŸ“‹';

            return `
                <div class="task-card ${statusClass}">
                    <div class="task-header">
                        <div>
                            <div class="task-title">${statusIcon} ${task.title}</div>
                            ${task.description ? `<div class="task-description">${task.description}</div>` : ''}
                        </div>
                        <div class="task-id">#${task.id}</div>
                    </div>
                    
                    <div class="task-meta">
                        <div class="meta-item">
                            <span>${priorityIcon}</span>
                            <span class="priority-badge ${priorityClass}">
                                ${task.priority}
                            </span>
                        </div>
                        
                        <div class="meta-item">
                            <span>ğŸ“Š</span>
                            <span class="status-badge status-${task.completed ? 'completed' : 'pending'}">
                                ${task.status}
                            </span>
                        </div>
                        
                        <div class="meta-item">
                            <span>ğŸ‘¤</span>
                            <span>@${task.username}</span>
                        </div>
                        
                        <div class="meta-item">
                            <span>ğŸ“…</span>
                            <span>${formatDate(task.createdAt)}</span>
                        </div>
                        
                        ${task.completedAt ? `
                            <div class="meta-item">
                                <span>âœ…</span>
                                <span>Ø§ÙƒØªÙ…Ù„: ${formatDate(task.completedAt)}</span>
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="task-actions">
                        ${!task.completed ? `
                            <button class="btn btn-success" onclick="completeTask(${task.id})">
                                âœ… Ø¥ÙƒÙ…Ø§Ù„
                            </button>
                        ` : ''}
                        <button class="btn btn-danger" onclick="deleteTask(${task.id})">
                            ğŸ—‘ï¸ Ø­Ø°Ù
                        </button>
                    </div>
                </div>
            `;
        }

        // Display Archive
        function displayArchive() {
            const container = document.getElementById('archiveContainer');
            
            if (archivedDays.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“¦</div>
                        <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£ÙŠØ§Ù… Ù…Ø¤Ø±Ø´ÙØ©</h3>
                        <p>Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„ØªÙŠ ØªÙ… Ø¥Ù†Ù‡Ø§Ø¤Ù‡Ø§</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = archivedDays.map(day => createArchivedDayCard(day)).join('');
        }

        // Create Archived Day Card
        function createArchivedDayCard(day) {
            const dayDate = new Date(day.date);
            const totalTasks = day.tasks.length;
            const completedTasks = day.tasks.filter(task => task.completed).length;
            const pendingTasks = totalTasks - completedTasks;
            
            return `
                <div class="archived-day">
                    <div class="archived-day-header">
                        <div class="archived-date">
                            ğŸ“… ${formatDate(dayDate)}
                        </div>
                        <div class="archived-stats">
                            <span>ğŸ“ ${totalTasks} Ù…Ù‡Ù…Ø©</span>
                            <span>âœ… ${completedTasks} Ù…ÙƒØªÙ…Ù„Ø©</span>
                            <span>â³ ${pendingTasks} Ù…Ø¹Ù„Ù‚Ø©</span>
                        </div>
                    </div>
                    <div class="tasks-grid">
                        ${day.tasks.map(task => createTaskCard(task)).join('')}
                    </div>
                </div>
            `;
        }

        // Complete Task
        async function completeTask(taskId) {
            try {
                const response = await fetch('/complete', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ taskId })
                });
                
                if (response.ok) {
                    // Update task locally
                    const task = tasks.find(t => t.id === taskId);
                    if (task) {
                        task.completed = true;
                        task.status = 'Ù…ÙƒØªÙ…Ù„';
                        task.completedAt = new Date().toISOString();
                    }
                    
                    updateStats();
                    displayCurrentTab();
                    showNotification('ØªÙ… Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù…Ù‡Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                } else {
                    showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù…Ù‡Ù…Ø©', 'error');
                }
            } catch (error) {
                // Fallback for demo - update locally
                const task = tasks.find(t => t.id === taskId);
                if (task) {
                    task.completed = true;
                    task.status = 'Ù…ÙƒØªÙ…Ù„';
                    task.completedAt = new Date().toISOString();
                }
                
                updateStats();
                displayCurrentTab();
                showNotification('ØªÙ… Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù…Ù‡Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            }
        }

        // Delete Task
        async function deleteTask(taskId) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù‡Ù…Ø©ØŸ')) {
                return;
            }
            
            try {
                const response = await fetch('/delete', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ taskId })
                });
                
                if (response.ok) {
                    // Remove task locally
                    tasks = tasks.filter(t => t.id !== taskId);
                    
                    updateStats();
                    displayCurrentTab();
                    showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                } else {
                    showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ù…Ø©', 'error');
                }
            } catch (error) {
                // Fallback for demo - delete locally
                tasks = tasks.filter(t => t.id !== taskId);
                
                updateStats();
                displayCurrentTab();
                showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            }
        }

        // End Current Day
        async function endCurrentDay() {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠØŸ Ø³ÙŠØªÙ… Ø£Ø±Ø´ÙØ© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù….')) {
                return;
            }
            
            try {
                const response = await fetch('/end-day', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        date: new Date().toISOString(),
                        tasks: tasks
                    })
                });
                
                if (response.ok) {
                    // Archive current day
                    archiveCurrentDay();
                    showNotification('ØªÙ… Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ… ÙˆØ£Ø±Ø´ÙØ© Ø§Ù„Ù…Ù‡Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                } else {
                    showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ…', 'error');
                }
            } catch (error) {
                // Fallback for demo - archive locally
                archiveCurrentDay();
                showNotification('ØªÙ… Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ… ÙˆØ£Ø±Ø´ÙØ© Ø§Ù„Ù…Ù‡Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            }
        }

        // Archive Current Day
        function archiveCurrentDay() {
            const today = new Date();
            const archivedDay = {
                date: dayStartTime.toISOString(),
                endDate: today.toISOString(),
                tasks: [...tasks]
            };
            
            archivedDays.unshift(archivedDay);
            tasks = [];
            dayStartTime = new Date();
            
            updateStats();
            displayCurrentTab();
            startDayTimer();
        }

        // Start Day Timer
        function startDayTimer() {
            if (dayTimer) {
                clearInterval(dayTimer);
            }
            
            dayTimer = setInterval(updateDayTimer, 1000);
            updateDayTimer();
        }

        // Update Day Timer
        function updateDayTimer() {
            const now = new Date();
            const startOfDay = new Date(dayStartTime);
            const timeDiff = now - startOfDay;
            
            // Calculate hours and minutes since day started
            const hours = Math.floor(timeDiff / (1000 * 60 * 60));
            const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
            
            const timerDisplay = document.getElementById('dayTimer');
            if (timerDisplay) {
                timerDisplay.textContent = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
            }
        }

        // Format Date
        function formatDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            
            if (date.toDateString() === now.toDateString()) {
                return `Ø§Ù„ÙŠÙˆÙ… ${date.toLocaleTimeString('ar-SA', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    hour12: true 
                })}`;
            }
            
            const yesterday = new Date(now);
            yesterday.setDate(yesterday.getDate() - 1);
            
            if (date.toDateString() === yesterday.toDateString()) {
                return `Ø£Ù…Ø³ ${date.toLocaleTimeString('ar-SA', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    hour12: true 
                })}`;
            }
            
            return date.toLocaleDateString('ar-SA', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                hour12: true
            });
        }

        // Show Notification
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // Show Loading
        function showLoading(show) {
            const loadingState = document.getElementById('loadingState');
            const contentArea = document.querySelector('.content-area');
            
            if (show) {
                loadingState.style.display = 'block';
                contentArea.style.opacity = '0.5';
            } else {
                loadingState.style.display = 'none';
                contentArea.style.opacity = '1';
            }
        }

        // Add Task Function (ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØªÙ‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹)
        function addTask() {
            const title = prompt('Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‡Ù…Ø©:');
            if (!title) return;
            
            const description = prompt('Ø£Ø¯Ø®Ù„ ÙˆØµÙ Ø§Ù„Ù…Ù‡Ù…Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):') || '';
            const priority = prompt('Ø£Ø¯Ø®Ù„ Ø£ÙˆÙ„ÙˆÙŠØ© Ø§Ù„Ù…Ù‡Ù…Ø© (Ø¹Ø§Ù„ÙŠ/Ù…ØªÙˆØ³Ø·/Ù…Ù†Ø®ÙØ¶):') || 'Ù…ØªÙˆØ³Ø·';
            
            const newTask = {
                id: Date.now(),
                title,
                description,
                priority,
                status: 'Ù…Ø¹Ù„Ù‚',
                completed: false,
                createdAt: new Date().toISOString(),
                userId: 123456789,
                username: 'current_user'
            };
            
            tasks.push(newTask);
            updateStats();
            displayCurrentTab();
            showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‡Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
        }

        // Keyboard Shortcuts
        document.addEventListener('keydown', (e) => {
            // Ctrl/Cmd + N: Add new task
            if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                e.preventDefault();
                addTask();
            }
            
            // Ctrl/Cmd + E: End day
            if ((e.ctrlKey || e.metaKey) && e.key === 'e') {
                e.preventDefault();
                endCurrentDay();
            }
            
            // Number keys for tab switching
            if (e.key >= '1' && e.key <= '6') {
                const tabs = ['all', 'today', 'pending', 'completed', 'high', 'archive'];
                const tabIndex = parseInt(e.key) - 1;
                if (tabs[tabIndex]) {
                    switchTab(tabs[tabIndex]);
                }
            }
        });

        // Auto-save functionality
        setInterval(() => {
            try {
                const data = {
                    tasks,
                    archivedDays,
                    dayStartTime: dayStartTime.toISOString()
                };
                
                // Save to localStorage as fallback
                localStorage.setItem('todoAppData', JSON.stringify(data));
            } catch (error) {
                console.log('Auto-save failed:', error);
            }
        }, 30000); // Save every 30 seconds

        // Load from localStorage if available
        function loadFromLocalStorage() {
            try {
                const saved = localStorage.getItem('todoAppData');
                if (saved) {
                    const data = JSON.parse(saved);
                    tasks = data.tasks || tasks;
                    archivedDays = data.archivedDays || archivedDays;
                    dayStartTime = data.dayStartTime ? new Date(data.dayStartTime) : dayStartTime;
                }
            } catch (error) {
                console.log('Failed to load from localStorage:', error);
            }
        }

        // Initialize localStorage fallback
        loadFromLocalStorage();

        // Add floating action button for adding tasks
        const fab = document.createElement('button');
        fab.innerHTML = 'â•';
        fab.style.cssText = `
            position: fixed;
            bottom: 30px;
            left: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            background: var(--primary-color);
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        `;
        
        fab.addEventListener('click', addTask);
        fab.addEventListener('mouseenter', () => {
            fab.style.transform = 'scale(1.1)';
            fab.style.boxShadow = '0 8px 20px rgba(74, 144, 226, 0.4)';
        });
        fab.addEventListener('mouseleave', () => {
            fab.style.transform = 'scale(1)';
            fab.style.boxShadow = '0 4px 12px rgba(74, 144, 226, 0.3)';
        });
        
        document.body.appendChild(fab);

        // Welcome message
        setTimeout(() => {
            showNotification('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø°ÙƒÙŠØ©! Ø§Ø³ØªØ®Ø¯Ù… Ctrl+N Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©', 'info');
        }, 1000);
    </script>
</body>
</html>